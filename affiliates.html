<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, user-scalable=no">
        <script src="https://supertestnet.github.io/bankify/super_nostr.js"></script>
        <script src="https://bundle.run/noble-secp256k1@1.2.14"></script>
        <style>
            * {
                box-sizing: border-box;
                font-size: 1.15rem;
                font-family: Arial, sans-serif;
            }
            html {
                max-width: 800px;
                padding: 3rem 1rem;
                margin: auto;
                line-height: 1.25;
                padding: 0;
            }
            body {
                margin: 3rem 1rem;
                word-wrap: break-word;
            }
            h1 {
                font-size: 2rem;
            }
            h2 {
                font-size: 1.5rem;
            }
            input {
                line-height: 1.25;
                width: 100%;
                height: 1.8rem;
                font-size: 1.15rem;
                border: 1px solid grey;
            }
            .hidden {
                display: none !important;
            }
            .link {
                margin-bottom: 1rem;
                padding: 1rem;
                border: 1px solid black;
                border-radius: 1rem;
                background-color: #cccccc;
                color: white;
                cursor: pointer;
            }
            @media screen and (max-width: 600px) {
            }
        </style>
    <script>
        var $ = document.querySelector.bind( document );
        var $$ = document.querySelectorAll.bind( document );
        var url_params = new URLSearchParams( window.location.search );
        var url_keys = url_params.keys();
        var $_GET = {}
        for ( var key of url_keys ) $_GET[ key ] = url_params.get( key );
        var hash_arr = window.location.href.substring( window.location.href.indexOf( "#" ) ).split( "#" );
        hash_arr.splice( 0, 1 );
        var params = {}
        hash_arr.forEach( item => {
            var vals = item.split( "=" );
            params[ vals[ 0 ] ] = vals[ 1 ];
        });
    </script>
    </head>
    <body>
        <div class="links"></div>
        <script>
            var events = null;
            (async()=>{
                events = await super_nostr.getEvents('wss://relay.damus.io', null, [$_GET.affiliate], [13166]);
                events[ 0 ].tags.forEach( tag => {
                    if ( tag[ 0 ] === "link" ) {
                        var div = document.createElement( "div" );
                        div.innerHTML = `
                            <div class="link">
                                <span class="link_desc"></span>
                            </div>
                        `;
                        var link = div.firstElementChild;
                        link.getElementsByClassName( "link_desc" )[ 0 ].innerText = tag[ 2 ];
                        link.onclick = () => window.open( tag[ 1 ], "_blank" );
                        $( '.links' ).append( link );
                    }
                    if ( tag[ 0 ] === "classified" ) {
                        console.log( tag );
                    }
                });
            })();
        </script>
    </body>
</html>
